---
title: Empath Engine (Insight Data Science project)
layout: post_norel
permalink: /pages/projects/insight
---

## About Insight Data Science

[Insight Data Science](http://insightdatascience.com/) is an intensive 
postdoctoral fellowship geared towards STEM PhDs making the transition to data 
science in industry.  The fellowship is centered around an individual demo 
product -- each fellow spends 3-4 weeks building a tech demonstration solving 
a real-world data problem from conceptualization all the way through to a 
self-contained presentation (typically in the form of a webapp for 
the product).  This demo is then presented to the sponsor companies over the 
following three weeks.

Rather than focusing on the technical aspects of the product (since, by and 
large, fellows enter the program already familiar with technical DS tools), 
Insight primarily focuses on the product side -- project conceptualization and 
effective presentation to broad (frequently nontechnical) audiences.  Bluntly, 
a project with the most cutting-edge tech out there doesn't mean much if it's 
presenting a solution to a problem no one cares about in a way that no one can 
follow.

## The Empath Engine

For my Insight project, I built the [_empath engine_](https://github.com/jrwalk/empath) 
-- a socially-driven recommender and sentiment reporter for antidepressant 
medications.  

The core problem is simple: while antidepressant prescription is extremely 
common (with some [one in eight Americans currently taking antidepressants](https://www.cdc.gov/nchs/products/databriefs/db283.htm)), 
the combination of social stigma and depressive symptoms themselves can make 
open discussion of symptoms, treatments, and medications difficult.  Moreover, 
there is significant trial and error involved in antidepressant prescription, 
with numerous patients cycling through several different medications before 
settling on one.  In short, the tendency towards isolation imposed by the 
disease interferes exactly where open discussion of others' experiences would 
be helpful.

**However**, it seems that if you just add some anonymity via typical social 
media channels into the mix, people will much more freely discuss their 
experiences.  I used data from [reddit](https://www.reddit.com) for this 
project, as it is suitably high traffic, anonymized behind persistent 
usernames, and supplies rich text data (comments capped at 10,000 characters, 
providing much more thorough information than e.g. Twitter) along with extensive 
metadata (timing, connections to other comments/posts) via an open API.

![comment](/images/projects/insight/wellbutrin_comment_zoomed.png){: .inline-img}

### The Data

Reddit provides access to all public comment and post data via an 
[open API](https://www.reddit.com/dev/api/).  However, this is geared more 
towards live tool development (e.g., comment bots or feed streams) rather than 
after-the-fact data mining -- in particular, the API is limited to two calls 
per second, with each call returning a maximum of 1000 query results due to 
upstream data structure limitations.  Fortunately, a reddit user (conveniently 
found through [/r/datasets](https://www.reddit.com/r/datasets)) had already 
assembled these into a dataset by sequentially running API calls over the 
course of around 10 months(!) daisy-chaining the API results together via the 
sequential IDs associated with each post, hosting the result at 
[pushshift.io](https://pushshift.io/).

Given this source, it is a fairly straightforward problem to find comments 
mentioning antidepressants recognized as antidepressants by the FDA.  However, 
Reddit currently receives up to _two million comments per day_, with each 
monthly data dump reaching into the tens of gigabytes... of which less than a 
hundredth of a percent were relevant for this project.  This necessitated 
streaming & out-of-core computing, which at the time I had little experience 
with -- speed of data acquisition was my first major hurdle.  Even so, in my 
limited time frame I assembled a set of some 30,000 relevant comments, indexed 
by the mentioned medication(s).

![source](/images/projects/insight/subreddits.png){: .inline-img}

These came from a variety of source "subreddits" (user-driven topical 
sub-forums on reddit) -- both from (a) a low "signal to noise" percentage of 
relevant posts coming from overall high-traffic subs 
(like [AskReddit](https://www.reddit.com/r/AskReddit)) and (b) a high percentage 
of relevant traffic from smaller, topically-specific subs (e.g. 
[/r/depression](https://www.reddit.com/r/depression)).

### Topic Modeling

### Semantic Parsing & Sentiment Analysis

### The Recommender

### Lessons Learned
